/*!
 * vue-charts v0.2.1
 * (c) 2018 Hayden Bickerton
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("lodash")):"function"==typeof define&&define.amd?define(["lodash"],t):e.VueCharts=t(e._)}(this,function(e){"use strict";function t(){var e=null,t=null;return{promise:new Promise(function(a,r){e=a,t=r}),resolve:e,reject:t}}function a(t,a,r){for(var n in r){var i=n,o=r[n];"ready"===i?o():e.isNil(a)||e.isNil(i)||e.isNil(o)?console.log("cannot bind event",a,i,o):google.visualization.events.addListener(a,i,o)}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["corechart"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"current",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"en";if(!Array.isArray(e))throw new TypeError("packages must be an array");if("current"!==t&&"number"!=typeof t&&"upcoming"!==t)throw new TypeError('version must be a number, "upcoming" or "current"');if(i||o)return u.promise;i=!0;var n=document.createElement("script");return n.setAttribute("src","https://www.gstatic.com/charts/loader.js"),n.onreadystatechange=n.onload=function(){var n={packages:e,language:r};a&&(n.mapsApiKey=a),google.charts.load(t,n),google.charts.setOnLoadCallback(function(){i=!1,o=!0,u.resolve()})},document.getElementsByTagName("head")[0].appendChild(n),u.promise}function n(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.component("vue-chart",c)}e="default"in e?e.default:e;var i=!1,o=!1,u=t(),s=t(),l={packages:{type:Array,default:function(){return["corechart"]}},version:{default:"current"},mapsApiKey:{default:!1},language:{type:String,default:"en"},chartType:{type:String,default:function(){return"LineChart"}},columns:{required:!0,type:Array},rows:{type:Array,default:function(){return[]}},options:{type:Object,default:function(){return{chart:{title:"Chart Title",subtitle:"Subtitle"},hAxis:{title:"X Label"},vAxis:{title:"Y Label"},width:"400px",height:"300px",animation:{duration:500,easing:"out"},colors:[]}}},timestamp:{type:Date,required:!1,default:function(){return null}}},c={name:"vue-chart",props:l,render:function(e){return e("div",{class:"vue-chart-container"},[e("div",{attrs:{id:this.chartId,class:"vue-chart"}})])},data:function(){return{chart:null,chartId:"X"+this._uid,wrapper:null,dataTable:[],hiddenColumns:[]}},watch:{timestamp:function(t,a){e.isNil(a)||e.isNil(this.chart)||e.isNil(this.wrapper)||this.drawChart()}},events:{redrawChart:function(){this.drawChart()}},mounted:function(){var e=this;r(e.packages,e.version,e.mapsApiKey,e.language).then(e.drawChart).then(function(){}).catch(function(e){throw e})},methods:{onSelectionChanged:function(){this.$emit("onSelectionChanged",this.chart.getSelection())},buildDataTable:function(){var t=this,a=new google.visualization.DataTable;return e.each(t.columns,function(e){a.addColumn(e)}),e.isEmpty(t.rows)||a.addRows(t.rows),a},updateDataTable:function(){var t=this;t.dataTable.removeRows(0,t.dataTable.getNumberOfRows()),t.dataTable.removeColumns(0,t.dataTable.getNumberOfColumns()),e.each(t.columns,function(e){t.dataTable.addColumn(e)}),e.isEmpty(t.rows)||t.dataTable.addRows(t.rows)},buildWrapper:function(e,t,a,r){return new google.visualization.ChartWrapper({chartType:e,dataTable:t,options:a,containerId:r})},buildChart:function(){var t=this,r=e.isEmpty(t.dataTable)?t.buildDataTable():t.dataTable;t.wrapper=t.buildWrapper(t.chartType,r,t.options,t.chartId),t.dataTable=t.wrapper.getDataTable(),google.visualization.events.addOneTimeListener(t.wrapper,"ready",function(){t.chart=t.wrapper.getChart(),s.resolve(),a(t,t.chart,{select:t.onSelectionChanged})})},drawChart:function(){var t=this;if((e.isEmpty(t.rows)||e.isObjectLike(t.rows))&&!e.isEmpty(t.columns))return e.isNull(t.chart)?t.buildChart():t.updateDataTable(),t.wrapper.draw(),s.promise}}};return n});