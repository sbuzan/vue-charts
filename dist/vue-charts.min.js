/*!
 * vue-charts v0.2.1
 * (c) 2018 Hayden Bickerton
 * Released under the MIT License.
 */
!function(e,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a(require("lodash")):"function"==typeof define&&define.amd?define(["lodash"],a):e.VueCharts=a(e._)}(this,function(e){"use strict";function a(){var e=null,a=null;return{promise:new Promise(function(t,n){e=t,a=n}),resolve:e,reject:a}}function t(a,t,n){for(var r in n){var o=r,i=n[r];"ready"===o?i():e.isNil(t)||e.isNil(o)||e.isNil(i)?console.log("cannot bind event",t,o,i):google.visualization.events.addListener(t,o,i)}}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["corechart"],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"42",t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"en";if(!Array.isArray(e))throw new TypeError("packages must be an array");if(o||i)return s.promise;o=!0;var r=document.createElement("script");return r.setAttribute("src","https://www.gstatic.com/charts/loader.js"),r.onreadystatechange=r.onload=function(){var r={packages:e,language:n};t&&(r.mapsApiKey=t),google.charts.load(a,r),google.charts.setOnLoadCallback(function(){o=!1,i=!0,s.resolve()})},document.getElementsByTagName("head")[0].appendChild(r),s.promise}function r(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.component("vue-chart",d)}e="default"in e?e.default:e;var o=!1,i=!1,s=a(),l=a(),d={name:"vue-chart",props:["packages","version","mapsApiKey","language","chartType","columns","rows","options","timestamp"],render:function(e){return e("div",{class:"vue-chart-container"},[e("div",{attrs:{id:this.chartId,class:"vue-chart"}})])},data:function(){return{chart:null,chartId:"X"+this._uid,wrapper:null,dataTable:[],hiddenColumns:[],googleLoaded:!1}},watch:{timestamp:function(a,t){!0===this.googleLoaded&&(e.isNil(t)||this.drawChart())},options:function(a,t){!0===this.googleLoaded&&(e.isNil(t)||this.forceRedraw())},chartType:function(a,t){!0===this.googleLoaded&&(e.isNil(t)||this.forceRedraw())}},events:{redrawChart:function(){this.drawChart()}},mounted:function(){var e=this;n(e.packages,e.version,e.mapsApiKey,e.language).then(function(){e.googleLoaded=!0,e.drawChart()}).catch(function(e){throw e})},methods:{forceRedraw:function(){this.wrapper=null,this.chart=null,this.drawChart()},onSelectionChanged:function(){this.$emit("onSelectionChanged",this.chart.getSelection())},buildDataTable:function(){var a=this,t=new google.visualization.DataTable;return e.each(a.columns,function(e){t.addColumn(e)}),e.isEmpty(a.rows)||t.addRows(a.rows),t},updateDataTable:function(){var a=this;a.dataTable.removeRows(0,a.dataTable.getNumberOfRows()),a.dataTable.removeColumns(0,a.dataTable.getNumberOfColumns()),e.each(a.columns,function(e){a.dataTable.addColumn(e)}),e.isEmpty(a.rows)||a.dataTable.addRows(a.rows)},buildWrapper:function(e,a,t,n){return new google.visualization.ChartWrapper({chartType:e,dataTable:a,options:t,containerId:n})},buildChart:function(){var a=this,n=e.isEmpty(a.dataTable)?a.buildDataTable():a.dataTable;a.wrapper=a.buildWrapper(a.chartType,n,a.options,a.chartId),a.dataTable=a.wrapper.getDataTable(),google.visualization.events.addOneTimeListener(a.wrapper,"ready",function(){a.chart=a.wrapper.getChart(),l.resolve(),t(a,a.chart,{select:a.onSelectionChanged})})},drawChart:function(){var a=this;if((e.isEmpty(a.rows)||e.isObjectLike(a.rows))&&!e.isEmpty(a.columns))return e.isNull(a.chart)?a.buildChart():a.updateDataTable(),a.wrapper.draw(),l.promise}}};return r});